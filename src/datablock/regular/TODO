Copy the data-block implementation from FSim

I need a lock !! Or something like that. Should I just use a pthread lock for now